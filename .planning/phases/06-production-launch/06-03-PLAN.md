---
phase: 06-production-launch
plan: 03
type: execute
wave: 3
depends_on: ["06-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All 6 pages are accessible at production domain (Home, Shop, Product Details, Our Story, Recipes, Order Confirmation)"
    - "SSL certificate is active (HTTPS enforced)"
    - "Sitemap.xml is accessible and lists all pages"
    - "Robots.txt is accessible and references sitemap"
    - "Stripe checkout creates a real checkout session (production keys working)"
    - "Stripe webhook receives and validates events"
    - "Google Analytics is loaded on production pages"
    - "Meta Pixel is loaded on production pages"
    - "Test order completes end-to-end"
  artifacts:
    - path: "https://jamaicahousebrand.com"
      provides: "Live production homepage"
    - path: "https://jamaicahousebrand.com/sitemap.xml"
      provides: "XML sitemap for search engines"
    - path: "https://jamaicahousebrand.com/robots.txt"
      provides: "Robots.txt with sitemap reference"
  key_links:
    - from: "https://jamaicahousebrand.com/shop"
      to: "Stripe Checkout"
      via: "POST /api/checkout -> stripe.checkout.sessions.create"
      pattern: "checkout.stripe.com"
    - from: "Stripe webhook"
      to: "https://jamaicahousebrand.com/api/webhooks/stripe"
      via: "POST with signature verification"
      pattern: "checkout.session.completed"
---

<objective>
Validate that the production site is fully functional: all pages load, payments work, analytics track, and SEO metadata is correct.

Purpose: Confirm the site is ready for real customers by testing every critical path in production.
Output: Verified production site at jamaicahousebrand.com, ready for launch.
</objective>

<execution_context>
@/Users/rfmstaff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rfmstaff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@/Users/rfmstaff/Desktop/jamaica-house-brand/.planning/phases/06-production-launch/06-02-SUMMARY.md
@/Users/rfmstaff/Desktop/jamaica-house-brand/src/app/sitemap.ts
@/Users/rfmstaff/Desktop/jamaica-house-brand/src/app/robots.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Automated production smoke tests</name>
  <files></files>
  <action>
    Run the following automated checks against the production domain. All commands use curl.

    **1. Page accessibility (all 6 pages must return 200):**
    ```
    curl -s -o /dev/null -w "%{http_code}" https://jamaicahousebrand.com
    curl -s -o /dev/null -w "%{http_code}" https://jamaicahousebrand.com/shop
    curl -s -o /dev/null -w "%{http_code}" https://jamaicahousebrand.com/our-story
    curl -s -o /dev/null -w "%{http_code}" https://jamaicahousebrand.com/recipes
    ```
    For product detail pages, use the slugs from `src/data/products.ts` to test at least one:
    ```
    curl -s -o /dev/null -w "%{http_code}" https://jamaicahousebrand.com/products/<first-product-slug>
    ```
    The success page (https://jamaicahousebrand.com/success) should also return 200.

    **2. SSL verification:**
    ```
    curl -sI https://jamaicahousebrand.com | grep -i "strict-transport-security"
    ```
    Should return a header. Also verify HTTPS redirect:
    ```
    curl -s -o /dev/null -w "%{http_code}" http://jamaicahousebrand.com
    ```
    Should return 301 or 308 (redirect to HTTPS).

    **3. SEO endpoints:**
    ```
    curl -s https://jamaicahousebrand.com/sitemap.xml | head -20
    ```
    Should return valid XML with URLs. Verify it includes /shop, /our-story, /recipes, and product URLs.
    ```
    curl -s https://jamaicahousebrand.com/robots.txt
    ```
    Should return robots.txt with sitemap reference to jamaicahousebrand.com/sitemap.xml.

    **4. Analytics script verification:**
    ```
    curl -s https://jamaicahousebrand.com | grep -o "googletagmanager.com/gtag" | head -1
    ```
    Should find GA4 script tag (if GA4 was configured).
    ```
    curl -s https://jamaicahousebrand.com | grep -o "connect.facebook.net" | head -1
    ```
    Should find Meta Pixel script (if Meta Pixel was configured). Note: Meta Pixel is loaded client-side via JS, so it may not appear in the initial HTML. Check for the noscript fallback img tag instead:
    ```
    curl -s https://jamaicahousebrand.com | grep -o "facebook.com/tr" | head -1
    ```

    **5. API health check:**
    Test that the checkout API endpoint responds (it should return 400 for empty cart, NOT 500):
    ```
    curl -s -X POST https://jamaicahousebrand.com/api/checkout -H "Content-Type: application/json" -d '{"items":[]}' -w "\n%{http_code}"
    ```
    Should return 400 with `{"error":"Cart is empty"}`.

    **6. www redirect:**
    ```
    curl -s -o /dev/null -w "%{http_code}" https://www.jamaicahousebrand.com
    ```
    Should return 200 or 308 redirect to non-www.

    Print a summary of all checks with PASS/FAIL for each.
  </action>
  <verify>All 6 pages return HTTP 200. SSL is active. Sitemap and robots.txt are valid. Checkout API returns 400 for empty cart (not 500). Analytics scripts are present (if configured).</verify>
  <done>Automated smoke tests pass: all pages accessible, SSL active, SEO endpoints valid, API responsive, analytics scripts loaded.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Manual end-to-end checkout and visual verification</name>
  <files></files>
  <action>
    Present the automated smoke test results to the user and ask them to verify the following manually.
  </action>
  <what-built>
    The complete Jamaica House Brand ecommerce site is deployed to production at https://jamaicahousebrand.com with:
    - All 6 pages (Home, Shop, Product Details, Our Story, Recipes, Order Confirmation)
    - Stripe production checkout
    - Google Analytics 4 tracking
    - Meta Pixel tracking
    - SSL/HTTPS
    - Sitemap and robots.txt
  </what-built>
  <how-to-verify>
    **Visual Check (2 minutes):**
    1. Visit https://jamaicahousebrand.com -- homepage loads with hero, product grid, brand story
    2. Click "Shop" in nav -- shop page shows product cards
    3. Click any product -- product detail page shows images, description, add-to-cart
    4. Click "Our Story" -- story page loads with restaurant heritage content
    5. Click "Recipes" -- recipes page shows recipe cards
    6. Click any recipe -- recipe detail page shows ingredients and instructions

    **Checkout Test (3 minutes):**
    1. Go to /shop, click "Add to Cart" on any product
    2. Open cart drawer, verify item appears with correct price
    3. Click "Checkout" -- should redirect to Stripe Checkout page
    4. Complete a real purchase with a real card (smallest item, you can refund after)
       - OR use Stripe's test card 4242 4242 4242 4242 if still in test mode
    5. After payment, should redirect to /success page
    6. Verify order appears in Stripe Dashboard -> Payments

    **Analytics Verification (2 minutes):**
    1. Open Google Analytics -> Realtime -> confirm your page views appear
    2. Open Meta Events Manager -> Test Events -> confirm PageView events fire
    3. If purchase was made, check for Purchase event in both GA4 and Meta

    **Webhook Verification:**
    1. After the test purchase, check Stripe Dashboard -> Developers -> Webhooks
    2. Click your endpoint -> check "Recent deliveries"
    3. Verify the checkout.session.completed event was delivered with 200 response
  </how-to-verify>
  <verify>User confirms all pages render, checkout works end-to-end, analytics fire, and webhook delivers.</verify>
  <done>Production site fully verified: pages load, payments process, analytics track, webhooks fire.</done>
  <resume-signal>Type "approved" if everything works, or describe any issues you see.</resume-signal>
</task>

</tasks>

<verification>
- All 6 pages return HTTP 200 at production domain
- SSL certificate is valid and HTTPS is enforced
- Sitemap.xml lists all pages
- Robots.txt references sitemap
- Checkout API creates Stripe sessions with production keys
- Webhook endpoint receives events
- GA4 tracks page views in realtime
- Meta Pixel fires PageView events
- End-to-end order completes successfully
</verification>

<success_criteria>
The Jamaica House Brand website is fully operational at https://jamaicahousebrand.com. All pages render correctly, checkout processes real payments via Stripe, analytics track visitor behavior, and search engines can discover all content. The site is ready for real customers.
</success_criteria>

<output>
After completion, create `.planning/phases/06-production-launch/06-03-SUMMARY.md`
</output>
